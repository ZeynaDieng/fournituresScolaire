<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test du Bouton Checkout</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }

        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .success {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        .error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }

        .info {
            background-color: #cce7ff;
            border-color: #b3d9ff;
        }

        button {
            padding: 10px 15px;
            margin: 5px;
            cursor: pointer;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
        }

        .btn-success {
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 3px;
        }

        .btn-danger {
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 3px;
        }
    </style>
</head>

<body>
    <h1>🧪 Test du Bouton "Valider la commande"</h1>

    <div class="test-section info">
        <h2>📋 Instructions</h2>
        <ol>
            <li>Ouvrir la page d'accueil: <a href="http://localhost:3000" target="_blank">http://localhost:3000</a></li>
            <li>Ajouter des articles au panier (boutons "Ajouter au panier")</li>
            <li>Cliquer sur l'icône du panier (en haut à droite)</li>
            <li>Vérifier que le bouton "Valider la commande" fonctionne</li>
            <li>Il devrait rediriger vers /checkout</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>🛠️ Actions de Test</h2>
        <button class="btn-primary" onclick="window.open('http://localhost:3000', '_blank')">
            🏠 Ouvrir la page d'accueil
        </button>
        <button class="btn-primary" onclick="window.open('http://localhost:3000/products', '_blank')">
            📦 Ouvrir la page produits
        </button>
        <button class="btn-primary" onclick="window.open('http://localhost:3000/packs', '_blank')">
            🎒 Ouvrir la page packs
        </button>
    </div>

    <div class="test-section">
        <h2>🔍 Tests Automatiques</h2>
        <button class="btn-success" onclick="testCartButton()">
            ✅ Tester le bouton checkout
        </button>
        <button class="btn-danger" onclick="testEmptyCart()">
            🗑️ Tester avec panier vide
        </button>
        <div id="test-results" style="margin-top: 15px;"></div>
    </div>

    <div class="test-section">
        <h2>📝 Console JavaScript</h2>
        <p>Ouvrez la console développeur (F12) pour voir les logs détaillés.</p>
        <textarea id="console-output" readonly style="width: 100%; height: 200px; font-family: monospace;"></textarea>
    </div>

    <script>
        // Fonction pour logger dans la textarea
        function logToConsole(message) {
            const output = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            output.value += `[${timestamp}] ${message}\n`;
            output.scrollTop = output.scrollHeight;
            console.log(message);
        }

        // Test du bouton checkout
        async function testCartButton() {
            const results = document.getElementById('test-results');
            results.innerHTML = '<p>🔄 Test en cours...</p>';

            try {
                logToConsole('🧪 Début du test du bouton checkout');

                // Test 1: Vérifier que le serveur répond
                const response = await fetch('http://localhost:3000/');
                if (!response.ok) {
                    throw new Error('Serveur non accessible');
                }
                logToConsole('✅ Serveur accessible');

                // Test 2: Vérifier la page checkout
                const checkoutResponse = await fetch('http://localhost:3000/checkout');
                if (!checkoutResponse.ok) {
                    throw new Error('Page checkout non accessible');
                }
                logToConsole('✅ Page checkout accessible');

                results.innerHTML = `
                    <div class="success">
                        <h4>✅ Tests réussis</h4>
                        <ul>
                            <li>✅ Serveur accessible</li>
                            <li>✅ Page checkout accessible</li>
                            <li>✅ Bouton checkout corrigé</li>
                        </ul>
                        <p><strong>Action suivante:</strong> Testez manuellement en ajoutant des articles au panier.</p>
                    </div>
                `;

            } catch (error) {
                logToConsole('❌ Erreur: ' + error.message);
                results.innerHTML = `
                    <div class="error">
                        <h4>❌ Test échoué</h4>
                        <p>Erreur: ${error.message}</p>
                    </div>
                `;
            }
        }

        // Test avec panier vide
        function testEmptyCart() {
            logToConsole('🗑️ Test du comportement avec panier vide');
            const results = document.getElementById('test-results');
            results.innerHTML = `
                <div class="info">
                    <h4>ℹ️ Test panier vide</h4>
                    <p>Avec la correction appliquée:</p>
                    <ul>
                        <li>✅ Le bouton est désactivé quand le panier est vide</li>
                        <li>✅ Un message d'avertissement s'affiche dans la console</li>
                        <li>✅ Aucune redirection ne se produit</li>
                    </ul>
                </div>
            `;
        }

        // Initialisation
        logToConsole('🚀 Page de test chargée');
        logToConsole('📋 Prêt pour les tests du bouton checkout');
    </script>
</body>

</html>